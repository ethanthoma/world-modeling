# Assuming you have a function to generate batches of data
def data_generator() -> Tuple[torch.Tensor, torch.Tensor]:
    # This function should return a batch of input data and targets
    # For example:
    # return torch.randn(32, 64, config.dim), torch.randint(0, config.vocab_size, (32, 64))
    ...
